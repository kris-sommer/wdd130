;/*FB_PKG_DELIM*/

__d("EBWorkerEBDBApi",["EBDB","EBDBConsistencyApi","EBLS","LSAuthorityLevel","LSEncryptedBackupsBackupTenancy","WALogger","WAResolvable"],(function(a,b,c,d,e,f,g){"use strict";var h,i=new(d("WAResolvable").Resolvable)();async function a(){var a=await d("EBLS").genLSClient();try{await d("EBDBConsistencyApi").startListeningDeviceRegistrations(a.db,d("EBDB").EBDBEnvironment.Worker)}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Error on EBDB init in Worker: ",""])),a)}finally{i.resolve(a.db)}}async function b(a){var b=await i.promise;await d("EBDBConsistencyApi").addNewDevice(b,d("EBDB").EBDBEnvironment.Worker,a)}async function e(a){var b=await i.promise;void d("EBDBConsistencyApi").trackConsistency(b,d("EBDB").EBDBEnvironment.Worker,a);return d("EBDBConsistencyApi").getDeviceId()}async function f(){var a=await d("EBDB").getEBDB();a=await a.store("secure_encrypted_backups_client_state").readAll();return a[0]}async function j(){var a=await d("EBDB").getEBDB();a=await a.store("secure_encrypted_backups_client_state").readAll();if((a==null?void 0:a.length)===0)return!1;a=a[0];var b=a.authorityLevel;a=a.backupTenancy;if(b==null)return!1;a=a!=null?a:c("LSEncryptedBackupsBackupTenancy").PRODUCTION;return Number(a)===c("LSEncryptedBackupsBackupTenancy").PRODUCTION&&Number(b)===c("LSAuthorityLevel").AUTHORITATIVE}g.startListeningEBDeviceRegistrations=a;g.addNewDevice=b;g.trackConsistency=e;g.getSecureEBClientState=f;g.isEBEnabledEBDB=j}),98);